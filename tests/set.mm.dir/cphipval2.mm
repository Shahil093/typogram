include "ccph.mm"
include "wcel.mm"
include "ci.mm"
include "wa.mm"
include "w3a.mm"
include "co.mm"
include "cfv.mm"
include "c2.mm"
include "cexp.mm"
include "cmin.mm"
include "cmul.mm"
include "caddc.mm"
include "c4.mm"
include "cdiv.mm"
include "wceq.mm"
include "simpl.mm"
include "3ad2ant1.mm"
include "cgrp.mm"
include "cngp.mm"
include "cphngp.mm"
include "adantr.mm"
include "ngpgrp.mm"
include "syl.mm"
include "grpcl.mm"
include "syl3an1.mm"
include "nmsq.mm"
include "syl2anc.mm"
include "simp2.mm"
include "simp3.mm"
include "cph2di.mm"
include "eqtrd.mm"
include "grpsubcl.mm"
include "cph2subdi.mm"
include "oveq12d.mm"
include "cc.mm"
include "cr.mm"
include "reipcl.mm"
include "adantlr.mm"
include "recnd.mm"
include "3adant3.mm"
include "3adant2.mm"
include "addcld.mm"
include "cphipcl.mm"
include "3com23.mm"
include "pnncand.mm"
include "clmod.mm"
include "cphlmod.mm"
include "simplr.mm"
include "simpr.mm"
include "lmodvscl.mm"
include "syl3anc.mm"
include "oveq2d.mm"
include "cneg.mm"
include "cphassir.mm"
include "cphassi.mm"
include "ax-icn.mm"
include "a1i.mm"
include "negicn.mm"
include "mulcld.mm"
include "adddid.mm"
include "c1.mm"
include "mulneg2i.mm"
include "ixi.mm"
include "negeqi.mm"
include "negneg1e1.mm"
include "3eqtri.mm"
include "oveq1i.mm"
include "mulassd.mm"
include "syl5reqr.mm"
include "mulid2d.mm"
include "oveq1d.mm"
include "addneg1mul.mm"
include "3eqtrd.mm"
include "subcld.mm"
include "add4d.mm"
include "ppncand.mm"
include "2timesd.mm"
include "eqcomd.mm"
include "2cnd.mm"
include "adddird.mm"
include "2p2e4.mm"
include "3eqtr2d.mm"
include "4cn.mm"
include "cc0.mm"
include "wne.mm"
include "4ne0.mm"
include "divcan3d.mm"
include "3eqtrrd.mm"

theorem cphipval2
  let cA: class A
  let cB: class B
  let c.pl: class .+
  let c.x: class .x.
  let cF: class F
  let c.xi: class .,
  let cK: class K
  let c.mi: class .-
  let cN: class N
  let cW: class W
  let cX: class X
  let vk: setvar k
  assume cphipfval.x: |- X = ( Base ` W )
  assume cphipfval.p: |- .+ = ( +g ` W )
  assume cphipfval.s: |- .x. = ( .s ` W )
  assume cphipfval.n: |- N = ( norm ` W )
  assume cphipfval.i: |- ., = ( .i ` W )
  assume cphipval2.m: |- .- = ( -g ` W )
  assume cphipval2.f: |- F = ( Scalar ` W )
  assume cphipval2.k: |- K = ( Base ` F )


  assert |- ( ( ( W e. CPreHil /\ _i e. K ) /\ A e. X /\ B e. X ) -> ( A ., B ) = ( ( ( ( ( N ` ( A .+ B ) ) ^ 2 ) - ( ( N ` ( A .- B ) ) ^ 2 ) ) + ( _i x. ( ( ( N ` ( A .+ ( _i .x. B ) ) ) ^ 2 ) - ( ( N ` ( A .- ( _i .x. B ) ) ) ^ 2 ) ) ) ) / 4 ) )

  proof
    cW
    ccph
    wcel
    #
    ci
    cK
    wcel
    #
    wa
    #
    cA
    cX
    wcel
    #
    cB
    cX
    wcel
    #
    w3a
    #
    cA
    cB
    c.pl
    co
    #
    cN
    cfv
    c2
    cexp
    co
    #
    cA
    cB
    c.mi
    co
    #
    cN
    cfv
    c2
    cexp
    co
    #
    cmin
    co
    #
    ci
    cA
    ci
    cB
    c.x
    co
    #
    c.pl
    co
    #
    cN
    cfv
    c2
    cexp
    co
    #
    cA
    @11
    c.mi
    co
    #
    cN
    cfv
    c2
    cexp
    co
    #
    cmin
    co
    #
    cmul
    co
    #
    caddc
    co
    #
    c4
    cdiv
    co
    cA
    cB
    c.xi
    co
    #
    cB
    cA
    c.xi
    co
    #
    caddc
    co
    #
    @21
    caddc
    co
    #
    @19
    @20
    cmin
    co
    #
    @23
    caddc
    co
    #
    caddc
    co
    #
    c4
    cdiv
    co
    @19
    @19
    caddc
    co
    #
    @26
    caddc
    co
    #
    c4
    cdiv
    co
    #
    @19
    @5
    @18
    @25
    c4
    cdiv
    @5
    @10
    @22
    @17
    @24
    caddc
    @5
    @10
    cA
    cA
    c.xi
    co
    #
    cB
    cB
    c.xi
    co
    #
    caddc
    co
    #
    @21
    caddc
    co
    #
    @31
    @21
    cmin
    co
    #
    cmin
    co
    @22
    @5
    @7
    @32
    @9
    @33
    cmin
    @5
    @7
    @6
    @6
    c.xi
    co
    #
    @32
    @5
    @0
    @6
    cX
    wcel
    #
    @7
    @34
    wceq
    @2
    @3
    @0
    @4
    @0
    @1
    simpl
    #
    3ad2ant1
    #
    @2
    cW
    cgrp
    wcel
    #
    @3
    @4
    @35
    @2
    cW
    cngp
    wcel
    #
    @38
    @0
    @39
    @1
    cW
    cphngp
    adantr
    cW
    ngpgrp
    syl
    #
    cX
    c.pl
    cW
    cA
    cB
    cphipfval.x
    cphipfval.p
    grpcl
    syl3an1
    @6
    c.xi
    cN
    cX
    cW
    cphipfval.x
    cphipfval.i
    cphipfval.n
    nmsq
    syl2anc
    @5
    cA
    cB
    cA
    cB
    c.pl
    c.xi
    cX
    cW
    cphipfval.i
    cphipfval.x
    cphipfval.p
    @37
    @2
    @3
    @4
    simp2
    #
    @2
    @3
    @4
    simp3
    #
    @41
    @42
    cph2di
    eqtrd
    @5
    @9
    @8
    @8
    c.xi
    co
    #
    @33
    @5
    @0
    @8
    cX
    wcel
    #
    @9
    @43
    wceq
    @37
    @2
    @38
    @3
    @4
    @44
    @40
    cX
    cW
    c.mi
    cA
    cB
    cphipfval.x
    cphipval2.m
    grpsubcl
    syl3an1
    @8
    c.xi
    cN
    cX
    cW
    cphipfval.x
    cphipfval.i
    cphipfval.n
    nmsq
    syl2anc
    @5
    cA
    cB
    cA
    cB
    c.xi
    c.mi
    cX
    cW
    cphipfval.i
    cphipfval.x
    cphipval2.m
    @37
    @41
    @42
    @41
    @42
    cph2subdi
    eqtrd
    oveq12d
    @5
    @31
    @21
    @21
    @5
    @29
    @30
    @2
    @3
    @29
    cc
    wcel
    @4
    @2
    @3
    wa
    @29
    @0
    @3
    @29
    cr
    wcel
    @1
    cA
    c.xi
    cX
    cW
    cphipfval.x
    cphipfval.i
    reipcl
    adantlr
    recnd
    3adant3
    #
    @2
    @4
    @30
    cc
    wcel
    @3
    @2
    @4
    wa
    #
    @30
    @0
    @4
    @30
    cr
    wcel
    @1
    cB
    c.xi
    cX
    cW
    cphipfval.x
    cphipfval.i
    reipcl
    adantlr
    recnd
    3adant2
    addcld
    @5
    @19
    @20
    @2
    @0
    @3
    @4
    @19
    cc
    wcel
    #
    @36
    cA
    cB
    c.xi
    cX
    cW
    cphipfval.x
    cphipfval.i
    cphipcl
    syl3an1
    #
    @2
    @4
    @3
    @20
    cc
    wcel
    #
    @2
    @0
    @4
    @3
    @49
    @36
    cB
    cA
    c.xi
    cX
    cW
    cphipfval.x
    cphipfval.i
    cphipcl
    syl3an1
    3com23
    #
    addcld
    #
    @51
    pnncand
    eqtrd
    @5
    @17
    ci
    @29
    @11
    @11
    c.xi
    co
    #
    caddc
    co
    #
    cA
    @11
    c.xi
    co
    #
    @11
    cA
    c.xi
    co
    #
    caddc
    co
    #
    caddc
    co
    #
    @53
    @56
    cmin
    co
    #
    cmin
    co
    #
    cmul
    co
    ci
    @56
    @56
    caddc
    co
    #
    cmul
    co
    #
    @24
    @5
    @16
    @59
    ci
    cmul
    @5
    @13
    @57
    @15
    @58
    cmin
    @5
    @13
    @12
    @12
    c.xi
    co
    #
    @57
    @5
    @0
    @12
    cX
    wcel
    #
    @13
    @62
    wceq
    @37
    @5
    @38
    @3
    @11
    cX
    wcel
    #
    @63
    @2
    @3
    @38
    @4
    @40
    3ad2ant1
    #
    @41
    @2
    @4
    @64
    @3
    @46
    cW
    clmod
    wcel
    #
    @1
    @4
    @64
    @2
    @66
    @4
    @0
    @66
    @1
    cW
    cphlmod
    adantr
    adantr
    @0
    @1
    @4
    simplr
    @2
    @4
    simpr
    ci
    c.x
    cF
    cK
    cX
    cW
    cB
    cphipfval.x
    cphipval2.f
    cphipfval.s
    cphipval2.k
    lmodvscl
    syl3anc
    3adant2
    #
    cX
    c.pl
    cW
    cA
    @11
    cphipfval.x
    cphipfval.p
    grpcl
    syl3anc
    @12
    c.xi
    cN
    cX
    cW
    cphipfval.x
    cphipfval.i
    cphipfval.n
    nmsq
    syl2anc
    @5
    cA
    @11
    cA
    @11
    c.pl
    c.xi
    cX
    cW
    cphipfval.i
    cphipfval.x
    cphipfval.p
    @37
    @41
    @67
    @41
    @67
    cph2di
    eqtrd
    @5
    @15
    @14
    @14
    c.xi
    co
    #
    @58
    @5
    @0
    @14
    cX
    wcel
    #
    @15
    @68
    wceq
    @37
    @5
    @38
    @3
    @64
    @69
    @65
    @41
    @67
    cX
    cW
    c.mi
    cA
    @11
    cphipfval.x
    cphipval2.m
    grpsubcl
    syl3anc
    @14
    c.xi
    cN
    cX
    cW
    cphipfval.x
    cphipfval.i
    cphipfval.n
    nmsq
    syl2anc
    @5
    cA
    @11
    cA
    @11
    c.xi
    c.mi
    cX
    cW
    cphipfval.i
    cphipfval.x
    cphipval2.m
    @37
    @41
    @67
    @41
    @67
    cph2subdi
    eqtrd
    oveq12d
    oveq2d
    @5
    @59
    @60
    ci
    cmul
    @5
    @53
    @56
    @56
    @5
    @29
    @52
    @45
    @5
    @0
    @64
    @64
    @52
    cc
    wcel
    @37
    @67
    @67
    @11
    @11
    c.xi
    cX
    cW
    cphipfval.x
    cphipfval.i
    cphipcl
    syl3anc
    addcld
    @5
    @54
    @55
    @5
    @0
    @3
    @64
    @54
    cc
    wcel
    @37
    @41
    @67
    cA
    @11
    c.xi
    cX
    cW
    cphipfval.x
    cphipfval.i
    cphipcl
    syl3anc
    @5
    @0
    @64
    @3
    @55
    cc
    wcel
    @37
    @67
    @41
    @11
    cA
    c.xi
    cX
    cW
    cphipfval.x
    cphipfval.i
    cphipcl
    syl3anc
    addcld
    #
    @70
    pnncand
    oveq2d
    @5
    @61
    ci
    ci
    cneg
    #
    @19
    cmul
    co
    #
    ci
    @20
    cmul
    co
    #
    caddc
    co
    #
    @74
    caddc
    co
    #
    cmul
    co
    ci
    @74
    cmul
    co
    #
    @76
    caddc
    co
    #
    @24
    @5
    @60
    @75
    ci
    cmul
    @5
    @56
    @74
    @56
    @74
    caddc
    @5
    @54
    @72
    @55
    @73
    caddc
    cA
    cB
    c.x
    cF
    c.xi
    cK
    cW
    cX
    cphipfval.x
    cphipfval.s
    cphipfval.i
    cphipval2.f
    cphipval2.k
    cphassir
    cA
    cB
    c.x
    cF
    c.xi
    cK
    cW
    cX
    cphipfval.x
    cphipfval.s
    cphipfval.i
    cphipval2.f
    cphipval2.k
    cphassi
    oveq12d
    #
    @78
    oveq12d
    oveq2d
    @5
    ci
    @74
    @74
    ci
    cc
    wcel
    @5
    ax-icn
    a1i
    #
    @5
    @72
    @73
    @5
    @71
    @19
    @71
    cc
    wcel
    @5
    negicn
    a1i
    #
    @48
    mulcld
    #
    @5
    ci
    @20
    @79
    @50
    mulcld
    #
    addcld
    #
    @83
    adddid
    @5
    @77
    c1
    @19
    cmul
    co
    #
    c1
    cneg
    #
    @20
    cmul
    co
    #
    caddc
    co
    #
    @87
    caddc
    co
    @24
    @5
    @76
    @87
    @76
    @87
    caddc
    @5
    @76
    ci
    @72
    cmul
    co
    #
    ci
    @73
    cmul
    co
    #
    caddc
    co
    @87
    @5
    ci
    @72
    @73
    @79
    @81
    @82
    adddid
    @5
    @88
    @84
    @89
    @86
    caddc
    @5
    @84
    ci
    @71
    cmul
    co
    #
    @19
    cmul
    co
    @88
    @90
    c1
    @19
    cmul
    @90
    ci
    ci
    cmul
    co
    #
    cneg
    @85
    cneg
    c1
    ci
    ci
    ax-icn
    ax-icn
    mulneg2i
    @91
    @85
    ixi
    negeqi
    negneg1e1
    3eqtri
    oveq1i
    @5
    ci
    @71
    @19
    @79
    @80
    @48
    mulassd
    syl5reqr
    @5
    @86
    @91
    @20
    cmul
    co
    @89
    @91
    @85
    @20
    cmul
    ixi
    oveq1i
    @5
    ci
    ci
    @20
    @79
    @79
    @50
    mulassd
    syl5reqr
    oveq12d
    eqtrd
    #
    @92
    oveq12d
    @5
    @87
    @23
    @87
    @23
    caddc
    @5
    @87
    @19
    @86
    caddc
    co
    #
    @23
    @5
    @84
    @19
    @86
    caddc
    @5
    @19
    @48
    mulid2d
    oveq1d
    @5
    @47
    @49
    @93
    @23
    wceq
    @48
    @50
    @19
    @20
    addneg1mul
    syl2anc
    eqtrd
    #
    @94
    oveq12d
    eqtrd
    3eqtrd
    3eqtrd
    oveq12d
    oveq1d
    @5
    @25
    @27
    c4
    cdiv
    @5
    @25
    @21
    @23
    caddc
    co
    #
    @95
    caddc
    co
    @27
    @5
    @21
    @21
    @23
    @23
    @51
    @51
    @5
    @19
    @20
    @48
    @50
    subcld
    #
    @96
    add4d
    @5
    @95
    @26
    @95
    @26
    caddc
    @5
    @19
    @20
    @19
    @48
    @50
    @48
    ppncand
    #
    @97
    oveq12d
    eqtrd
    oveq1d
    @5
    @28
    c4
    @19
    cmul
    co
    #
    c4
    cdiv
    co
    @19
    @5
    @27
    @98
    c4
    cdiv
    @5
    @27
    c2
    @19
    cmul
    co
    #
    @99
    caddc
    co
    c2
    c2
    caddc
    co
    #
    @19
    cmul
    co
    @98
    @5
    @26
    @99
    @26
    @99
    caddc
    @5
    @99
    @26
    @5
    @19
    @48
    2timesd
    eqcomd
    #
    @101
    oveq12d
    @5
    c2
    c2
    @19
    @5
    2cnd
    #
    @102
    @48
    adddird
    @5
    @100
    c4
    @19
    cmul
    @100
    c4
    wceq
    @5
    2p2e4
    a1i
    oveq1d
    3eqtr2d
    oveq1d
    @5
    @19
    c4
    @48
    c4
    cc
    wcel
    @5
    4cn
    a1i
    c4
    cc0
    wne
    @5
    4ne0
    a1i
    divcan3d
    eqtrd
    3eqtrrd
end
