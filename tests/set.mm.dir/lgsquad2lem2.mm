include "c2.mm"
include "cmul.mm"
include "co.mm"
include "cgcd.mm"
include "c1.mm"
include "wceq.mm"
include "clgs.mm"
include "cneg.mm"
include "cmin.mm"
include "cdiv.mm"
include "cexp.mm"
include "cn.mm"
include "wcel.mm"
include "2nn.mm"
include "a1i.mm"
include "cz.mm"
include "nnzd.mm"
include "2z.mm"
include "gcdcom.mm"
include "sylancl.mm"
include "cdvds.mm"
include "wbr.mm"
include "wn.mm"
include "cprime.mm"
include "wb.mm"
include "2prm.mm"
include "coprm.mm"
include "sylancr.mm"
include "mpbid.mm"
include "eqtrd.mm"
include "rpmulgcd.mm"
include "syl31anc.mm"
include "wi.mm"
include "cv.mm"
include "cc0.mm"
include "oveq1.mm"
include "oveq2.mm"
include "oveq12d.mm"
include "1m1e0.mm"
include "syl6eq.mm"
include "oveq1d.mm"
include "2cn.mm"
include "2ne0.mm"
include "div0i.mm"
include "oveq2d.mm"
include "eqeq12d.mm"
include "imbi2d.mm"
include "eqeq1d.mm"
include "imbi12d.mm"
include "1t1e1.mm"
include "cc.mm"
include "neg1cn.mm"
include "exp0.mm"
include "ax-mp.mm"
include "eqtr4i.mm"
include "sq1.mm"
include "oveq1i.mm"
include "wne.mm"
include "wa.mm"
include "1z.mm"
include "ax-1ne0.mm"
include "pm3.2i.mm"
include "1gcd.mm"
include "syl.mm"
include "lgssq.mm"
include "mp3an2i.mm"
include "syl5eqr.mm"
include "oveq2i.mm"
include "1nn.mm"
include "gcd1.mm"
include "lgssq2.mm"
include "syl3anc.mm"
include "cn0.mm"
include "nnm1nn0.mm"
include "nn0cnd.mm"
include "halfcld.mm"
include "mul02d.mm"
include "3eqtr4a.mm"
include "a1d.mm"
include "csn.mm"
include "cdif.mm"
include "simprl.mm"
include "prmz.mm"
include "ad2antrl.mm"
include "adantr.mm"
include "zmulcl.mm"
include "simprr.mm"
include "dvdsmul1.mm"
include "rpdvds.mm"
include "syl32anc.mm"
include "prmrp.mm"
include "eldifsn.mm"
include "sylanbrc.mm"
include "prmnn.mm"
include "eqtr3d.mm"
include "jca.mm"
include "syldan.mm"
include "exp32.mm"
include "com12.mm"
include "cuz.mm"
include "cfv.mm"
include "jcab.mm"
include "simplrl.mm"
include "eluz2nn.mm"
include "simplrr.mm"
include "nnmulcld.mm"
include "n2dvds1.mm"
include "ad2antrr.mm"
include "eluzelz.mm"
include "anim12i.mm"
include "ad2antlr.mm"
include "dvdsgcd.mm"
include "mpan2d.mm"
include "simpr.mm"
include "breq2d.mm"
include "sylibd.mm"
include "mtoi.mm"
include "adantrr.mm"
include "dvdsmul2.mm"
include "eqidd.mm"
include "simpld.mm"
include "syl2anc.mm"
include "simprrl.mm"
include "mpd.mm"
include "simprd.mm"
include "simprrr.mm"
include "lgsquad2lem1.mm"
include "com23.mm"
include "expcom.mm"
include "a2d.mm"
include "syl5bir.mm"
include "prmind.mm"
include "mpcom.mm"

theorem lgsquad2lem2
  let wph: wff ph
  let wps: wff ps
  let vx: setvar x
  let vk: setvar k
  let vm: setvar m
  let cM: class M
  let cN: class N
  let vn: setvar n
  let vy: setvar y
  assume lgsquad2.1: |- ( ph -> M e. NN )
  assume lgsquad2.2: |- ( ph -> -. 2 || M )
  assume lgsquad2.3: |- ( ph -> N e. NN )
  assume lgsquad2.4: |- ( ph -> -. 2 || N )
  assume lgsquad2.5: |- ( ph -> ( M gcd N ) = 1 )
  assume lgsquad2lem2.f: |- ( ( ph /\ ( m e. ( Prime \ { 2 } ) /\ ( m gcd N ) = 1 ) ) -> ( ( m /L N ) x. ( N /L m ) ) = ( -u 1 ^ ( ( ( m - 1 ) / 2 ) x. ( ( N - 1 ) / 2 ) ) ) )
  assume lgsquad2lem2.s: |- ( ps <-> A. x e. ( 1 ... k ) ( ( x gcd ( 2 x. N ) ) = 1 -> ( ( x /L N ) x. ( N /L x ) ) = ( -u 1 ^ ( ( ( x - 1 ) / 2 ) x. ( ( N - 1 ) / 2 ) ) ) ) )

  disjoint M m
  disjoint m x
  disjoint N m
  disjoint N x
  disjoint m ph
  disjoint ph x
  disjoint m n
  disjoint m y
  disjoint n x
  disjoint n y
  disjoint N n
  disjoint x y
  disjoint N y
  disjoint n ph
  disjoint ph y
  assert |- ( ph -> ( ( M /L N ) x. ( N /L M ) ) = ( -u 1 ^ ( ( ( M - 1 ) / 2 ) x. ( ( N - 1 ) / 2 ) ) ) )

  proof
    wph
    cM
    c2
    cN
    cmul
    co
    #
    cgcd
    co
    #
    c1
    wceq
    #
    cM
    cN
    clgs
    co
    #
    cN
    cM
    clgs
    co
    #
    cmul
    co
    #
    c1
    cneg
    #
    cM
    c1
    cmin
    co
    #
    c2
    cdiv
    co
    #
    cN
    c1
    cmin
    co
    #
    c2
    cdiv
    co
    #
    cmul
    co
    #
    cexp
    co
    #
    wceq
    #
    wph
    @1
    cM
    cN
    cgcd
    co
    #
    c1
    wph
    cM
    cn
    wcel
    #
    c2
    cn
    wcel
    #
    cN
    cn
    wcel
    #
    cM
    c2
    cgcd
    co
    #
    c1
    wceq
    @1
    @14
    wceq
    lgsquad2.1
    @16
    wph
    2nn
    a1i
    lgsquad2.3
    wph
    @18
    c2
    cM
    cgcd
    co
    #
    c1
    wph
    cM
    cz
    wcel
    #
    c2
    cz
    wcel
    #
    @18
    @19
    wceq
    wph
    cM
    lgsquad2.1
    nnzd
    #
    2z
    cM
    c2
    gcdcom
    sylancl
    wph
    c2
    cM
    cdvds
    wbr
    wn
    #
    @19
    c1
    wceq
    #
    lgsquad2.2
    wph
    c2
    cprime
    wcel
    #
    @20
    @23
    @24
    wb
    2prm
    @22
    c2
    cM
    coprm
    sylancr
    mpbid
    eqtrd
    cM
    c2
    cN
    rpmulgcd
    syl31anc
    lgsquad2.5
    eqtrd
    @15
    wph
    @2
    @13
    wi
    #
    lgsquad2.1
    wph
    vm
    cv
    #
    @0
    cgcd
    co
    #
    c1
    wceq
    #
    @27
    cN
    clgs
    co
    #
    cN
    @27
    clgs
    co
    #
    cmul
    co
    #
    @6
    @27
    c1
    cmin
    co
    #
    c2
    cdiv
    co
    #
    @10
    cmul
    co
    #
    cexp
    co
    #
    wceq
    #
    wi
    #
    wi
    wph
    @29
    c1
    cN
    clgs
    co
    #
    cN
    c1
    clgs
    co
    #
    cmul
    co
    #
    @6
    cc0
    @10
    cmul
    co
    #
    cexp
    co
    #
    wceq
    #
    wi
    #
    wi
    wph
    vx
    cv
    #
    @0
    cgcd
    co
    #
    c1
    wceq
    #
    @46
    cN
    clgs
    co
    #
    cN
    @46
    clgs
    co
    #
    cmul
    co
    #
    @6
    @46
    c1
    cmin
    co
    #
    c2
    cdiv
    co
    #
    @10
    cmul
    co
    #
    cexp
    co
    #
    wceq
    #
    wi
    #
    wi
    #
    wph
    vy
    cv
    #
    @0
    cgcd
    co
    #
    c1
    wceq
    #
    @59
    cN
    clgs
    co
    #
    cN
    @59
    clgs
    co
    #
    cmul
    co
    #
    @6
    @59
    c1
    cmin
    co
    #
    c2
    cdiv
    co
    #
    @10
    cmul
    co
    #
    cexp
    co
    #
    wceq
    #
    wi
    #
    wi
    #
    wph
    @46
    @59
    cmul
    co
    #
    @0
    cgcd
    co
    #
    c1
    wceq
    #
    @72
    cN
    clgs
    co
    #
    cN
    @72
    clgs
    co
    #
    cmul
    co
    #
    @6
    @72
    c1
    cmin
    co
    #
    c2
    cdiv
    co
    #
    @10
    cmul
    co
    #
    cexp
    co
    #
    wceq
    #
    wi
    #
    wi
    #
    wph
    @26
    wi
    vm
    vx
    vy
    cM
    @27
    c1
    wceq
    #
    @38
    @45
    wph
    @85
    @37
    @44
    @29
    @85
    @32
    @41
    @36
    @43
    @85
    @30
    @39
    @31
    @40
    cmul
    @27
    c1
    cN
    clgs
    oveq1
    @27
    c1
    cN
    clgs
    oveq2
    oveq12d
    @85
    @35
    @42
    @6
    cexp
    @85
    @34
    cc0
    @10
    cmul
    @85
    @34
    cc0
    c2
    cdiv
    co
    cc0
    @85
    @33
    cc0
    c2
    cdiv
    @85
    @33
    c1
    c1
    cmin
    co
    cc0
    @27
    c1
    c1
    cmin
    oveq1
    1m1e0
    syl6eq
    oveq1d
    c2
    2cn
    2ne0
    div0i
    syl6eq
    oveq1d
    oveq2d
    eqeq12d
    imbi2d
    imbi2d
    @27
    @46
    wceq
    #
    @38
    @57
    wph
    @86
    @29
    @48
    @37
    @56
    @86
    @28
    @47
    c1
    @27
    @46
    @0
    cgcd
    oveq1
    eqeq1d
    @86
    @32
    @51
    @36
    @55
    @86
    @30
    @49
    @31
    @50
    cmul
    @27
    @46
    cN
    clgs
    oveq1
    @27
    @46
    cN
    clgs
    oveq2
    oveq12d
    @86
    @35
    @54
    @6
    cexp
    @86
    @34
    @53
    @10
    cmul
    @86
    @33
    @52
    c2
    cdiv
    @27
    @46
    c1
    cmin
    oveq1
    oveq1d
    oveq1d
    oveq2d
    eqeq12d
    imbi12d
    imbi2d
    @27
    @59
    wceq
    #
    @38
    @70
    wph
    @87
    @29
    @61
    @37
    @69
    @87
    @28
    @60
    c1
    @27
    @59
    @0
    cgcd
    oveq1
    eqeq1d
    @87
    @32
    @64
    @36
    @68
    @87
    @30
    @62
    @31
    @63
    cmul
    @27
    @59
    cN
    clgs
    oveq1
    @27
    @59
    cN
    clgs
    oveq2
    oveq12d
    @87
    @35
    @67
    @6
    cexp
    @87
    @34
    @66
    @10
    cmul
    @87
    @33
    @65
    c2
    cdiv
    @27
    @59
    c1
    cmin
    oveq1
    oveq1d
    oveq1d
    oveq2d
    eqeq12d
    imbi12d
    imbi2d
    @27
    @72
    wceq
    #
    @38
    @83
    wph
    @88
    @29
    @74
    @37
    @82
    @88
    @28
    @73
    c1
    @27
    @72
    @0
    cgcd
    oveq1
    eqeq1d
    @88
    @32
    @77
    @36
    @81
    @88
    @30
    @75
    @31
    @76
    cmul
    @27
    @72
    cN
    clgs
    oveq1
    @27
    @72
    cN
    clgs
    oveq2
    oveq12d
    @88
    @35
    @80
    @6
    cexp
    @88
    @34
    @79
    @10
    cmul
    @88
    @33
    @78
    c2
    cdiv
    @27
    @72
    c1
    cmin
    oveq1
    oveq1d
    oveq1d
    oveq2d
    eqeq12d
    imbi12d
    imbi2d
    @27
    cM
    wceq
    #
    @38
    @26
    wph
    @89
    @29
    @2
    @37
    @13
    @89
    @28
    @1
    c1
    @27
    cM
    @0
    cgcd
    oveq1
    eqeq1d
    @89
    @32
    @5
    @36
    @12
    @89
    @30
    @3
    @31
    @4
    cmul
    @27
    cM
    cN
    clgs
    oveq1
    @27
    cM
    cN
    clgs
    oveq2
    oveq12d
    @89
    @35
    @11
    @6
    cexp
    @89
    @34
    @8
    @10
    cmul
    @89
    @33
    @7
    c2
    cdiv
    @27
    cM
    c1
    cmin
    oveq1
    oveq1d
    oveq1d
    oveq2d
    eqeq12d
    imbi12d
    imbi2d
    wph
    @44
    @29
    wph
    c1
    c1
    cmul
    co
    #
    @6
    cc0
    cexp
    co
    #
    @41
    @43
    @90
    c1
    @91
    1t1e1
    @6
    cc
    wcel
    @91
    c1
    wceq
    neg1cn
    @6
    exp0
    ax-mp
    eqtr4i
    wph
    @39
    c1
    @40
    c1
    cmul
    wph
    @39
    c1
    c2
    cexp
    co
    #
    cN
    clgs
    co
    #
    c1
    @92
    c1
    cN
    clgs
    sq1
    oveq1i
    c1
    cz
    wcel
    #
    c1
    cc0
    wne
    #
    wa
    wph
    cN
    cz
    wcel
    #
    c1
    cN
    cgcd
    co
    c1
    wceq
    #
    @93
    c1
    wceq
    @94
    @95
    1z
    ax-1ne0
    pm3.2i
    wph
    cN
    lgsquad2.3
    nnzd
    #
    wph
    @96
    @97
    @98
    cN
    1gcd
    syl
    c1
    cN
    lgssq
    mp3an2i
    syl5eqr
    wph
    @40
    cN
    @92
    clgs
    co
    #
    c1
    @92
    c1
    cN
    clgs
    sq1
    oveq2i
    wph
    @96
    c1
    cn
    wcel
    #
    cN
    c1
    cgcd
    co
    c1
    wceq
    #
    @99
    c1
    wceq
    @98
    @100
    wph
    1nn
    a1i
    wph
    @96
    @101
    @98
    cN
    gcd1
    syl
    cN
    c1
    lgssq2
    syl3anc
    syl5eqr
    oveq12d
    wph
    @42
    cc0
    @6
    cexp
    wph
    @10
    wph
    @9
    wph
    @9
    wph
    @17
    @9
    cn0
    wcel
    lgsquad2.3
    cN
    nnm1nn0
    syl
    nn0cnd
    halfcld
    mul02d
    oveq2d
    3eqtr4a
    a1d
    wph
    @27
    cprime
    wcel
    #
    @38
    wph
    @102
    @29
    @37
    wph
    @102
    @29
    wa
    #
    @27
    cprime
    c2
    csn
    cdif
    wcel
    #
    @27
    cN
    cgcd
    co
    #
    c1
    wceq
    #
    wa
    @37
    wph
    @103
    wa
    #
    @104
    @106
    @107
    @102
    @27
    c2
    wne
    #
    @104
    wph
    @102
    @29
    simprl
    #
    @107
    @27
    c2
    cgcd
    co
    c1
    wceq
    #
    @108
    @107
    @27
    cz
    wcel
    #
    @21
    @0
    cz
    wcel
    #
    @29
    c2
    @0
    cdvds
    wbr
    #
    @110
    @102
    @111
    wph
    @29
    @27
    prmz
    ad2antrl
    @21
    @107
    2z
    a1i
    @107
    @21
    @96
    @112
    2z
    @107
    cN
    wph
    @17
    @103
    lgsquad2.3
    adantr
    #
    nnzd
    #
    c2
    cN
    zmulcl
    #
    sylancr
    wph
    @102
    @29
    simprr
    #
    @107
    @21
    @96
    @113
    2z
    @115
    c2
    cN
    dvdsmul1
    #
    sylancr
    @27
    c2
    @0
    rpdvds
    syl32anc
    #
    @107
    @102
    @25
    @110
    @108
    wb
    @109
    2prm
    @27
    c2
    prmrp
    sylancl
    mpbid
    @27
    cprime
    c2
    eldifsn
    sylanbrc
    @107
    @28
    @105
    c1
    @107
    @27
    cn
    wcel
    #
    @16
    @17
    @110
    @28
    @105
    wceq
    @102
    @120
    wph
    @29
    @27
    prmnn
    ad2antrl
    @16
    @107
    2nn
    a1i
    @114
    @119
    @27
    c2
    cN
    rpmulgcd
    syl31anc
    @117
    eqtr3d
    jca
    lgsquad2lem2.f
    syldan
    exp32
    com12
    @58
    @71
    wa
    wph
    @57
    @70
    wa
    #
    wi
    @46
    c2
    cuz
    cfv
    #
    wcel
    #
    @59
    @122
    wcel
    #
    wa
    #
    @84
    wph
    @57
    @70
    jcab
    @125
    wph
    @121
    @83
    wph
    @125
    @121
    @83
    wi
    wph
    @125
    wa
    #
    @74
    @121
    @82
    @126
    @74
    @121
    @82
    @126
    @74
    @121
    wa
    #
    wa
    #
    @46
    @59
    @72
    cN
    @128
    @46
    @59
    @128
    @123
    @46
    cn
    wcel
    wph
    @123
    @124
    @127
    simplrl
    @46
    eluz2nn
    syl
    #
    @128
    @124
    @59
    cn
    wcel
    wph
    @123
    @124
    @127
    simplrr
    @59
    eluz2nn
    syl
    #
    nnmulcld
    @126
    @74
    c2
    @72
    cdvds
    wbr
    #
    wn
    @121
    @126
    @74
    wa
    #
    @131
    c2
    c1
    cdvds
    wbr
    #
    n2dvds1
    @132
    @131
    c2
    @73
    cdvds
    wbr
    #
    @133
    @132
    @131
    @113
    @134
    @132
    @21
    @96
    @113
    2z
    wph
    @96
    @125
    @74
    @98
    ad2antrr
    #
    @118
    sylancr
    @21
    @132
    @72
    cz
    wcel
    #
    @112
    @131
    @113
    wa
    @134
    wi
    2z
    @132
    @46
    cz
    wcel
    #
    @59
    cz
    wcel
    #
    wa
    #
    @136
    @125
    @139
    wph
    @74
    @123
    @137
    @124
    @138
    c2
    @46
    eluzelz
    c2
    @59
    eluzelz
    anim12i
    ad2antlr
    #
    @46
    @59
    zmulcl
    syl
    #
    @132
    @21
    @96
    @112
    2z
    @135
    @116
    sylancr
    #
    c2
    @72
    @0
    dvdsgcd
    mp3an2i
    mpan2d
    @132
    @73
    c1
    c2
    cdvds
    @126
    @74
    simpr
    #
    breq2d
    sylibd
    mtoi
    adantrr
    wph
    @17
    @125
    @127
    lgsquad2.3
    ad2antrr
    wph
    c2
    cN
    cdvds
    wbr
    wn
    @125
    @127
    lgsquad2.4
    ad2antrr
    @126
    @74
    @72
    cN
    cgcd
    co
    c1
    wceq
    #
    @121
    @132
    @136
    @96
    @112
    @74
    cN
    @0
    cdvds
    wbr
    #
    @144
    @141
    @135
    @142
    @143
    @132
    @21
    @96
    @145
    2z
    @135
    c2
    cN
    dvdsmul2
    sylancr
    @72
    cN
    @0
    rpdvds
    syl32anc
    adantrr
    @129
    @130
    @128
    @72
    eqidd
    @128
    @48
    @56
    @126
    @74
    @48
    @121
    @132
    @47
    @0
    @46
    cgcd
    co
    #
    c1
    @132
    @137
    @112
    @47
    @146
    wceq
    @132
    @137
    @138
    @140
    simpld
    #
    @142
    @46
    @0
    gcdcom
    syl2anc
    @132
    @112
    @137
    @136
    @0
    @72
    cgcd
    co
    #
    c1
    wceq
    #
    @46
    @72
    cdvds
    wbr
    #
    @146
    c1
    wceq
    @142
    @147
    @141
    @132
    @148
    @73
    c1
    @132
    @112
    @136
    @148
    @73
    wceq
    @142
    @141
    @0
    @72
    gcdcom
    syl2anc
    @143
    eqtrd
    #
    @132
    @139
    @150
    @140
    @46
    @59
    dvdsmul1
    syl
    @0
    @46
    @72
    rpdvds
    syl32anc
    eqtrd
    adantrr
    @126
    @74
    @57
    @70
    simprrl
    mpd
    @128
    @61
    @69
    @126
    @74
    @61
    @121
    @132
    @60
    @0
    @59
    cgcd
    co
    #
    c1
    @132
    @138
    @112
    @60
    @152
    wceq
    @132
    @137
    @138
    @140
    simprd
    #
    @142
    @59
    @0
    gcdcom
    syl2anc
    @132
    @112
    @138
    @136
    @149
    @59
    @72
    cdvds
    wbr
    #
    @152
    c1
    wceq
    @142
    @153
    @141
    @151
    @132
    @139
    @154
    @140
    @46
    @59
    dvdsmul2
    syl
    @0
    @59
    @72
    rpdvds
    syl32anc
    eqtrd
    adantrr
    @126
    @74
    @57
    @70
    simprrr
    mpd
    lgsquad2lem1
    exp32
    com23
    expcom
    a2d
    syl5bir
    prmind
    mpcom
    mpd
end
